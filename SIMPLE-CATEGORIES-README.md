# üì¶ –ü—Ä–æ—Å—Ç–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤

## üéØ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

–£–¥–∞–ª–µ–Ω–∞ —Å–ª–æ–∂–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ —Å–æ–∑–¥–∞–Ω–∞ –ø—Ä–æ—Å—Ç–∞—è, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–∂–µ—Ç –≤ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ.

## üóÉÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î

### catalog_categories
```sql
- id (uuid, PK)
- key (varchar) - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á –∫–∞—Ç–µ–≥–æ—Ä–∏–∏  
- name (varchar) - –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- description (text) - –æ–ø–∏—Å–∞–Ω–∏–µ
- icon (varchar) - —ç–º–æ–¥–∑–∏ –∏–∫–æ–Ω–∫–∞
- sort_order (integer) - –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
- is_active (boolean) - –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- created_at, updated_at (timestamp)
```

### –°–≤—è–∑–∏ —Å —Ç–æ–≤–∞—Ä–∞–º–∏
```sql
catalog_verified_products.category_id -> catalog_categories.id
catalog_user_products.category_id -> catalog_categories.id
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç—ã –ø–æ –ø–æ—Ä—è–¥–∫—É:

```bash
# 1. –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é —Å–∏—Å—Ç–µ–º—É (–µ—Å–ª–∏ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–ª–∏)
psql -f final-cleanup-categories.sql

# 2. –î–æ–±–∞–≤–ª—è–µ–º —Å–≤—è–∑–∏ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏  
psql -f add-category-relations.sql
```

### 2. –ë–∞–∑–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É–∂–µ —Å–æ–∑–¥–∞–Ω—ã:
- üì± –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞
- üöó –ê–≤—Ç–æ—Ç–æ–≤–∞—Ä—ã  
- üè≠ –ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å
- üíä –ó–¥–æ—Ä–æ–≤—å–µ –∏ –º–µ–¥–∏—Ü–∏–Ω–∞
- üëï –¢–µ–∫—Å—Ç–∏–ª—å –∏ –æ–¥–µ–∂–¥–∞
- üèóÔ∏è –°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ
- üçé –ü—Ä–æ–¥—É–∫—Ç—ã –ø–∏—Ç–∞–Ω–∏—è
- üè† –î–æ–º –∏ –±—ã—Ç

## üì° API Endpoints

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
```
GET /api/catalog/categories
```
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å —Å—á–µ—Ç—á–∏–∫–∞–º–∏ —Ç–æ–≤–∞—Ä–æ–≤ –∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤.

### –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
```
POST /api/catalog/categories
{
  "name": "–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏", 
  "icon": "üéØ",
  "sort_order": 10
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
```
GET /api/catalog/simple-products?category_key=electronics
GET /api/catalog/simple-products?category_id=uuid
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `category_key` - –∫–ª—é—á –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (electronics, automotive, etc.)
- `category_id` - UUID –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `limit` - –ª–∏–º–∏—Ç —Ç–æ–≤–∞—Ä–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 50)
- `offset` - —Å–º–µ—â–µ–Ω–∏–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏  
- `search` - –ø–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é/–æ–ø–∏—Å–∞–Ω–∏—é

## üé® –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### SimpleCategorySelector
```tsx
import SimpleCategorySelector from '@/components/catalog/SimpleCategorySelector'

<SimpleCategorySelector
  onCategorySelect={(category) => console.log(category)}
  onClose={() => setShowSelector(false)}
  authToken={token}
/>
```

## üîß –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ –¥–æ–±–∞–≤–ª—è–π—Ç–µ `category_id`:

```typescript
const newProduct = {
  name: "iPhone 15",
  description: "–ü–æ—Å–ª–µ–¥–Ω—è—è –º–æ–¥–µ–ª—å",
  price: "80000",
  currency: "RUB", 
  category_id: "electronics-category-uuid", // ‚Üê –í–∞–∂–Ω–æ!
  supplier_id: "supplier-uuid",
  // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
}

await supabase
  .from('catalog_user_products')
  .insert(newProduct)
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–π
node test-simple-categories.js
```

## üí° –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Ç–æ–≤–∞—Ä–∞:

```typescript
function detectCategory(productName: string): string | null {
  const keywords = {
    'electronics': ['iphone', 'android', '–∫–æ–º–ø—å—é—Ç–µ—Ä', '–Ω–æ—É—Ç–±—É–∫'],
    'automotive': ['—à–∏–Ω—ã', '–º–∞—Å–ª–æ', '—Ñ–∏–ª—å—Ç—Ä', '–∑–∞–ø—á–∞—Å—Ç–∏'],
    'industrial': ['—Å—Ç–∞–Ω–æ–∫', '–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ', '–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç'],
    // ...
  }
  
  const name = productName.toLowerCase()
  for (const [category, terms] of Object.entries(keywords)) {
    if (terms.some(term => name.includes(term))) {
      return category
    }
  }
  
  return null
}
```

### –°—á–µ—Ç—á–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—á–∏—Ç–∞–µ—Ç:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ –∫–æ–º–Ω–∞—Ç–∞–º (verified/user)

### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ
–õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è–π—Ç–µ –Ω–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —á–µ—Ä–µ–∑ API –∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é –≤ –ë–î:

```sql
INSERT INTO catalog_categories (key, name, description, icon, sort_order, is_active) 
VALUES ('beauty', '–ö—Ä–∞—Å–æ—Ç–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ', '–ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ —Ç–æ–≤–∞—Ä—ã –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã', 'üíÑ', 9, true);
```

## ‚úÖ –ì–æ—Ç–æ–≤–∞—è –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å–∏—Å—Ç–µ–º–∞!

–ü—Ä–æ—Å—Ç–∞—è, –ø–æ–Ω—è—Ç–Ω–∞—è, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–∂–µ—Ç –≤ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ, –∞ –Ω–µ —É—Å–ª–æ–∂–Ω–∏—Ç –µ—ë.