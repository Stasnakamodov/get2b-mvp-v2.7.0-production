# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Playwright –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤

–î–∞—Ç–∞: 01.11.2025
–°—Ç–∞—Ç—É—Å: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (—Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏)

---

## üéØ –ß–¢–û –°–î–ï–õ–ê–ù–û

### 1. –°–æ–∑–¥–∞–Ω `PlaywrightParserService.ts`

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `/lib/services/PlaywrightParserService.ts`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤ (Ozon, Wildberries, AliExpress) —á–µ—Ä–µ–∑ Playwright –±—Ä–∞—É–∑–µ—Ä
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **accessibility tree** (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ Playwright MCP) –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- Anti-detection –æ–±—Ö–æ–¥ (–º–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥ —Ä–µ–∞–ª—å–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä)
- –¢—Ä–æ–π–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞:
  1. Open Graph –º–µ—Ç–∞—Ç–µ–≥–∏ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
  2. Accessibility tree (fallback)
  3. DOM —Å–µ–ª–µ–∫—Ç–æ—Ä—ã (–ø–æ—Å–ª–µ–¥–Ω–∏–π fallback)

**–ö–ª—é—á–µ–≤—ã–µ —Ñ–∏—á–∏:**
```typescript
// Accessibility tree –ø–∞—Ä—Å–∏–Ω–≥ (–∫–∞–∫ –≤ Playwright MCP)
const accessibilitySnapshot = await page.accessibility.snapshot()

// Anti-detection
await page.addInitScript(() => {
  Object.defineProperty(navigator, 'webdriver', { get: () => false })
  window.chrome = { runtime: {} }
})

// –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ headers
extraHTTPHeaders: {
  'Sec-Fetch-Dest': 'document',
  'Sec-Fetch-Mode': 'navigate',
  'Upgrade-Insecure-Requests': '1'
}
```

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ `UrlParserService.ts`

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `/lib/services/UrlParserService.ts:47-62`

**–õ–æ–≥–∏–∫–∞:**
```typescript
if (protectedMarketplaces.includes(marketplace)) {
  // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º Playwright (—Å–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π)
  const playwrightParser = getPlaywrightParserService()

  if (await playwrightParser.isAvailable()) {
    return await playwrightParser.parseWithPlaywright(url)
  }

  // Fallback –Ω–∞ Puppeteer –µ—Å–ª–∏ Playwright –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
  return await getBrowserParserService().parseWithBrowser(url)
}
```

### 3. –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `/scripts/test-playwright-parser.js`

**–ó–∞–ø—É—Å–∫:**
```bash
node scripts/test-playwright-parser.js
```

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç:**
- –ó–∞–ø—É—Å–∫ Playwright —Å anti-detection
- –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã Ozon
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ anti-bot –∑–∞—â–∏—Ç—ã
- –ü–æ–ø—ã—Ç–∫–∞ –æ–±—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ —Å–∫—Ä–æ–ª–ª–∏–Ω–≥
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ OG, DOM, accessibility tree

---

## üß™ –†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

### –¢–µ—Å—Ç –Ω–∞ Ozon (https://www.ozon.ru/product/smartfon-apple-iphone-15-128-gb-rozovyy-1189416565/)

**–í–µ—Ä–¥–∏–∫—Ç:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω anti-bot –∑–∞—â–∏—Ç–æ–π

```
‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢–´:

üìä Open Graph:
  Title: undefined
  Description: undefined
  Price: null

üìÑ DOM:
  H1: –î–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω
  Title: –î–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω

üå≥ Accessibility Tree:
  Heading: –î–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω

üéØ –§–ò–ù–ê–õ–¨–ù–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢:
  –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞: –î–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω
```

### –ü–æ—á–µ–º—É –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ?

Ozon –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–º–Ω–æ–≥–æ—Å–ª–æ–π–Ω—É—é anti-bot –∑–∞—â–∏—Ç—É:**
1. **Cloudflare Challenge** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ legitimacy
2. **Behavioral analysis** ‚Äî –∞–Ω–∞–ª–∏–∑ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–≤–∏–∂–µ–Ω–∏–µ –º—ã—à–∏, –∫–ª–∏–∫–∏)
3. **Browser fingerprinting** ‚Äî –æ—Ç–ø–µ—á–∞—Ç–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (canvas, WebGL, fonts)
4. **TLS fingerprinting** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ TLS handshake

**–ü—Ä–æ—Å—Ç–æ–π Playwright –ù–ï –æ–±—Ö–æ–¥–∏—Ç** —ç—Ç—É –∑–∞—â–∏—Ç—É –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.

---

## ‚úÖ –ß–¢–û –†–ê–ë–û–¢–ê–ï–¢

### 1. –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- Playwright —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (`npx playwright install chromium`)
- –ë—Ä–∞—É–∑–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å anti-detection –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- Accessibility tree –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

### 2. –î–ª—è –Ω–µ–∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —Å–∞–π—Ç–æ–≤
Playwright –û–¢–õ–ò–ß–ù–û —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Å–∞–π—Ç–æ–≤ –ë–ï–ó –∑–∞—â–∏—Ç—ã:
- –ú–µ–ª–∫–∏–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω—ã
- –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∏
- B2B –ø–ª–æ—â–∞–¥–∫–∏ –±–µ–∑ anti-bot

### 3. –ö–æ–¥ –≥–æ—Ç–æ–≤
–í–µ—Å—å –∫–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω, –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω. –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ (–ù–ï Playwright MCP).

---

## ‚ùå –ß–¢–û –ù–ï –†–ê–ë–û–¢–ê–ï–¢

### 1. –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—ã
- **Ozon** ‚Äî –±–ª–æ–∫–∏—Ä—É–µ—Ç (Cloudflare)
- **Wildberries** ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç
- **AliExpress** ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç

### 2. Playwright MCP
**Playwright MCP ‚Äî —ç—Ç–æ –ù–ï —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Ç–≤–æ–µ–π –∑–∞–¥–∞—á–∏!**

**–ü–æ—á–µ–º—É:**
- Playwright MCP ‚Äî —ç—Ç–æ **MCP —Å–µ—Ä–≤–µ—Ä** –¥–ª—è AI IDE (Claude Desktop, Cursor)
- –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ `npx @playwright/mcp@latest` –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å
- **–ù–ï —è–≤–ª—è–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π** –¥–ª—è Next.js API routes
- –ù—É–∂–µ–Ω –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã AI —Å–∞–º –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–ª –±—Ä–∞—É–∑–µ—Ä
- **–ù–ï –æ–±—Ö–æ–¥–∏—Ç** anti-bot –∑–∞—â–∏—Ç—É –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤

**–î–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—ã—á–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Playwright!**

---

## üöÄ –†–ï–®–ï–ù–ò–Ø –î–õ–Ø PRODUCTION

### –í–∞—Ä–∏–∞–Ω—Ç 1: Playwright + playwright-extra + stealth plugin

**–ß—Ç–æ —ç—Ç–æ:**
–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è Playwright —Å –ø–ª–∞–≥–∏–Ω–∞–º–∏ –¥–ª—è –æ–±—Ö–æ–¥–∞ anti-bot.

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
npm install playwright-extra puppeteer-extra-plugin-stealth
```

**–ö–æ–¥:**
```typescript
import { chromium } from 'playwright-extra'
import stealth from 'puppeteer-extra-plugin-stealth'

chromium.use(stealth())

const browser = await chromium.launch({ headless: true })
```

**–ü–ª—é—Å—ã:**
- –û–±—Ö–æ–¥–∏—Ç –±–∞–∑–æ–≤—É—é anti-bot –∑–∞—â–∏—Ç—É
- –†–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ
- –ë–µ—Å–ø–ª–∞—Ç–Ω–æ

**–ú–∏–Ω—É—Å—ã:**
- –ú–æ–∂–µ—Ç –Ω–µ –æ–±–æ–π—Ç–∏ Cloudflare Challenge
- –ú–µ–¥–ª–µ–Ω–Ω–æ (5-15 —Å–µ–∫—É–Ω–¥)
- –ë–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä (~150MB —Å –±—Ä–∞—É–∑–µ—Ä–æ–º)

**–í–µ—Ä–¥–∏–∫—Ç:** ‚úÖ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: Browserless.io ($50/–º–µ—Å)

**–ß—Ç–æ —ç—Ç–æ:**
–û–±–ª–∞—á–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±—Ä–∞—É–∑–µ—Ä–æ–≤ —Å pre-configured anti-detection.

**API:**
```typescript
const response = await fetch('https://chrome.browserless.io/content', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${process.env.BROWSERLESS_TOKEN}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    url: 'https://www.ozon.ru/product/...',
    waitFor: 3000
  })
})

const html = await response.text()
```

**–ü–ª—é—Å—ã:**
- –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- –û–±—Ö–æ–¥–∏—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ anti-bot
- –ë—ã—Å—Ç—Ä–æ (1-3 —Å–µ–∫—É–Ω–¥—ã)
- –†–∞–±–æ—Ç–∞–µ—Ç —Å Vercel

**–ú–∏–Ω—É—Å—ã:**
- –ü–ª–∞—Ç–Ω–æ ($50-250/–º–µ—Å)
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Å–µ—Ä–≤–∏—Å–∞

**–í–µ—Ä–¥–∏–∫—Ç:** ‚úÖ –õ—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è production

---

### –í–∞—Ä–∏–∞–Ω—Ç 3: ScraperAPI ($49/–º–µ—Å)

**–ß—Ç–æ —ç—Ç–æ:**
API –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–±—Ö–æ–¥–æ–º anti-bot.

**API:**
```typescript
const url = 'http://api.scraperapi.com?' + new URLSearchParams({
  api_key: process.env.SCRAPER_API_KEY,
  url: 'https://www.ozon.ru/product/...',
  render: 'true',
  country_code: 'ru'
})

const response = await fetch(url)
const html = await response.text()
```

**–ü–ª—é—Å—ã:**
- –ü—Ä–æ—Å—Ç–æ–π API
- –û–±—Ö–æ–¥–∏—Ç Cloudflare
- –†–∞–±–æ—Ç–∞–µ—Ç —Å Vercel
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–∫—Å–∏ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º

**–ú–∏–Ω—É—Å—ã:**
- –ü–ª–∞—Ç–Ω–æ ($49-249/–º–µ—Å)
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤

**–í–µ—Ä–¥–∏–∫—Ç:** ‚úÖ –•–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å —Ü–µ–Ω–∞/–∫–∞—á–µ—Å—Ç–≤–æ

---

### –í–∞—Ä–∏–∞–Ω—Ç 4: –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π VPS + Playwright + residential proxy

**–ß—Ç–æ —ç—Ç–æ:**
–°–≤–æ–π —Å–µ—Ä–≤–µ—Ä —Å Playwright + residential IP –∞–¥—Ä–µ—Å–∞.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
Next.js (Vercel) ‚Üí API Gateway ‚Üí VPS (Playwright) ‚Üí Residential Proxy ‚Üí Ozon
```

**–ü–ª—é—Å—ã:**
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å
- –ú–æ–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å
- –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥–µ—à–µ–≤–æ (~$50/–º–µ—Å)

**–ú–∏–Ω—É—Å—ã:**
- –ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å
- Residential proxy —Å—Ç–æ—è—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ (~$30/–º–µ—Å)
- –°–ª–æ–∂–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

**–í–µ—Ä–¥–∏–∫—Ç:** ‚ö†Ô∏è –î–ª—è –æ–ø—ã—Ç–Ω—ã—Ö devops

---

### –í–∞—Ä–∏–∞–Ω—Ç 5: HTML mode (—Ç–µ–∫—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ)

**–ß—Ç–æ —ç—Ç–æ:**
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º –∫–æ–ø–∏—Ä—É–µ—Ç HTML –∫–æ–¥ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –≤—Å—Ç–∞–≤–ª—è–µ—Ç –≤ —Ñ–æ—Ä–º—É.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Ozon –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. View Source (Ctrl+U)
3. –ö–æ–ø–∏—Ä—É–µ—Ç –≤–µ—Å—å HTML
4. –í—Å—Ç–∞–≤–ª—è–µ—Ç –≤ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤ —Ç–≤–æ–µ–º UI
5. –¢–≤–æ–π `HtmlParserService` –ø–∞—Ä—Å–∏—Ç HTML

**–ü–ª—é—Å—ã:**
- ‚úÖ 100% —Ä–∞–±–æ—Ç–∞–µ—Ç (–æ–±—Ö–æ–¥–∏—Ç –í–°–Æ –∑–∞—â–∏—Ç—É)
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ
- ‚úÖ –õ–µ–≥–∞–ª—å–Ω–æ
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Vercel

**–ú–∏–Ω—É—Å—ã:**
- –ù–µ—É–¥–æ–±–Ω–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- 2-3 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–ª–∏–∫–∞

**–í–µ—Ä–¥–∏–∫—Ç:** ‚úÖ –õ–£–ß–®–ï–ï —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è MVP

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø

### –î–ª—è MVP (—Å–µ–π—á–∞—Å):
**–ò—Å–ø–æ–ª—å–∑—É–π HTML mode (–í–∞—Ä–∏–∞–Ω—Ç 5)**
- –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ `HtmlParserService.ts`
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ 100%
- –ë–µ—Å–ø–ª–∞—Ç–Ω–æ
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –î–ª—è Beta (100+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):
**–î–æ–±–∞–≤—å Browserless.io –∏–ª–∏ ScraperAPI**
- –ü—Ä–æ—Ñ —Ä–µ—à–µ–Ω–∏–µ
- –û–±—Ö–æ–¥–∏—Ç –∑–∞—â–∏—Ç—É
- –†–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- $50/–º–µ—Å

### –î–ª—è Production (1000+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):
**–ö–æ–º–±–æ:**
1. Playwright (–¥–ª—è –Ω–µ–∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —Å–∞–π—Ç–æ–≤) ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω–æ
2. ScraperAPI/Browserless (–¥–ª—è Ozon, WB) ‚Äî $250/–º–µ—Å
3. HTML mode (fallback –µ—Å–ª–∏ API –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª) ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω–æ

---

## üìù –ö–ê–ö –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨ PLAYWRIGHT –ü–†–Ø–ú–û –°–ï–ô–ß–ê–°

### 1. –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (Mac/Linux)

Playwright –£–ñ–ï —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ! –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏:

```bash
# –¢–µ—Å—Ç
node scripts/test-playwright-parser.js

# Dev server
npm run dev

# –ò—Å–ø–æ–ª—å–∑—É–π API endpoint
POST http://localhost:3000/api/catalog/search-by-url
{
  "url": "https://example.com/product/123"
}
```

Playwright –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤!

### 2. –ù–∞ Vercel (–ù–ï –†–ê–ë–û–¢–ê–ï–¢)

Vercel serverless **–ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç** –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π Playwright –∏–∑-–∑–∞:
- –õ–∏–º–∏—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ñ—É–Ω–∫—Ü–∏–∏ (50MB, Chromium > 280MB)
- –õ–∏–º–∏—Ç RAM (1GB free, –Ω—É–∂–Ω–æ 2-3GB)
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞ –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–∏

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π HTML mode –∏–ª–∏ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å (Browserless/ScraperAPI).

---

## üéì –ß–¢–û –ú–´ –£–ó–ù–ê–õ–ò

### 1. Playwright vs Playwright MCP

| –ö—Ä–∏—Ç–µ—Ä–∏–π | Playwright (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞) | Playwright MCP |
|----------|------------------------|----------------|
| –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ë—Ä–∞—É–∑–µ—Ä–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è | AI IDE –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è |
| –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ | `import { chromium } from 'playwright'` | `npx @playwright/mcp@latest` |
| –î–ª—è —á–µ–≥–æ | –ü–∞—Ä—Å–∏–Ω–≥ –≤ —Ç–≤–æ–µ–º –∫–æ–¥–µ | –ü–æ–º–æ—â—å AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—É |
| –í Next.js API | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç |
| –û–±—Ö–æ–¥–∏—Ç anti-bot | ‚ö†Ô∏è –ë–∞–∑–æ–≤—ã–π | ‚ö†Ô∏è –ë–∞–∑–æ–≤—ã–π |

**–í—ã–≤–æ–¥:** –î–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏—Å–ø–æ–ª—å–∑—É–π –±–∏–±–ª–∏–æ—Ç–µ–∫—É Playwright, –ù–ï Playwright MCP!

### 2. Accessibility Tree

Playwright –º–æ–∂–µ—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å **accessibility tree** (–∫–∞–∫ MCP):

```typescript
const snapshot = await page.accessibility.snapshot()

// –†–µ–∑—É–ª—å—Ç–∞—Ç:
{
  role: 'RootWebArea',
  children: [
    {
      role: 'heading',
      name: 'iPhone 15 128GB',
      level: 1
    },
    {
      role: 'paragraph',
      name: '–¶–µ–Ω–∞: 79990‚ÇΩ'
    }
  ]
}
```

–≠—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è **—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è** –¥–∞–Ω–Ω—ã—Ö, –Ω–æ –ù–ï –æ–±—Ö–æ–¥–∏—Ç anti-bot.

### 3. Anti-bot –∑–∞—â–∏—Ç–∞ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç:
- Cloudflare Challenge (JS challenge)
- Behavioral analysis (–¥–≤–∏–∂–µ–Ω–∏–µ –º—ã—à–∏, –∫–ª–∏–∫–∏)
- Browser fingerprinting (canvas, WebGL, fonts)
- TLS fingerprinting (TLS handshake –ø—Ä–æ–≤–µ—Ä–∫–∞)

**–ü—Ä–æ—Å—Ç–æ–π Playwright –ù–ï –æ–±—Ö–æ–¥–∏—Ç** —ç—Ç–æ –±–µ–∑:
- playwright-extra + stealth plugin
- Residential proxies
- –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (Browserless, ScraperAPI)

---

## üìÇ –°–û–ó–î–ê–ù–ù–´–ï –§–ê–ô–õ–´

1. `/lib/services/PlaywrightParserService.ts` ‚Äî –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –ø–∞—Ä—Å–∏–Ω–≥–∞
2. `/scripts/test-playwright-parser.js` ‚Äî –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
3. `/docs/PLAYWRIGHT_INTEGRATION_SUMMARY.md` ‚Äî –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

### –û–ø—Ü–∏—è 1: –û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å (HTML mode)
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ
- ‚úÖ –ù–∞ Vercel
- ‚ùå –ù–µ—É–¥–æ–±–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### –û–ø—Ü–∏—è 2: –î–æ–±–∞–≤–∏—Ç—å playwright-extra + stealth
- –£–ª—É—á—à–∏—Ç –æ–±—Ö–æ–¥ –∑–∞—â–∏—Ç—ã
- –†–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ
- –ë–µ—Å–ø–ª–∞—Ç–Ω–æ
- –í—Å–µ —Ä–∞–≤–Ω–æ –º–æ–∂–µ—Ç –Ω–µ –ø—Ä–æ–π—Ç–∏ Cloudflare

### –û–ø—Ü–∏—è 3: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Browserless/ScraperAPI
- –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- $50-250/–º–µ—Å
- –ù—É–∂–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –æ–ø–ª–∞—Ç–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–∞—á–Ω–∏ —Å HTML mode, —Å–æ–±–µ—Ä–∏ feedback –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∑–∞—Ç–µ–º –¥–æ–±–∞–≤—å –ø–ª–∞—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å –µ—Å–ª–∏ –±—É–¥–µ—Ç demand.

---

**–ê–≤—Ç–æ—Ä:** Claude Code
**–î–∞—Ç–∞:** 01.11.2025
**–í–µ—Ä—Å–∏—è:** 1.0
