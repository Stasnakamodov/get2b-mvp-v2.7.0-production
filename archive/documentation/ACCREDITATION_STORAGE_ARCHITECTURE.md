# üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∞–∫–∫—Ä–µ–¥–∏—Ç–∞—Ü–∏–∏

## ‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 1. –í—Å–µ —Ñ–∞–π–ª—ã –≤ –æ–¥–Ω–æ–º –±–∞–∫–µ—Ç–µ
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞—Ä—Ç–∏–Ω–∫–∏, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ `project-images`
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:** –ü—É—Ç–∞–Ω–∏—Ü–∞, —Å–ª–æ–∂–Ω–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –Ω–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

### 2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤
- **–ü—Ä–æ–±–ª–µ–º–∞:** –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (PDF) –≤ –±–∞–∫–µ—Ç–µ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:** –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ MIME-—Ç–∏–ø—ã

### 3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –±–∞–∫–µ—Ç–æ–≤
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –±–∞–∫–µ—Ç–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- **–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:** –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –ø–æ–ª–∏—Ç–∏–∫

## ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∫–µ—Ç–æ–≤

#### üñºÔ∏è `project-images` - –¢–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
```
project-images/
‚îî‚îÄ‚îÄ accreditation/
    ‚îî‚îÄ‚îÄ {application_id}/
        ‚îî‚îÄ‚îÄ products/
            ‚îî‚îÄ‚îÄ {product_index}/
                ‚îî‚îÄ‚îÄ images/
                    ‚îú‚îÄ‚îÄ {timestamp}_product_image.jpg
                    ‚îú‚îÄ‚îÄ {timestamp}_product_image.png
                    ‚îî‚îÄ‚îÄ {timestamp}_product_image.svg
```

**–¢–∏–ø—ã —Ñ–∞–π–ª–æ–≤:** `image/jpeg`, `image/png`, `image/svg+xml`, `image/webp`

#### üìÑ `accreditation-certificates` - –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —Ç–æ–≤–∞—Ä–æ–≤
```
accreditation-certificates/
‚îî‚îÄ‚îÄ accreditation/
    ‚îî‚îÄ‚îÄ {application_id}/
        ‚îî‚îÄ‚îÄ products/
            ‚îî‚îÄ‚îÄ {product_index}/
                ‚îî‚îÄ‚îÄ certificates/
                    ‚îú‚îÄ‚îÄ {timestamp}_quality_certificate.pdf
                    ‚îú‚îÄ‚îÄ {timestamp}_safety_certificate.pdf
                    ‚îî‚îÄ‚îÄ {timestamp}_compliance_certificate.doc
```

**–¢–∏–ø—ã —Ñ–∞–π–ª–æ–≤:** `application/pdf`, `application/msword`, `application/vnd.openxmlformats-officedocument.wordprocessingml.document`

#### ‚öñÔ∏è `accreditation-documents` - –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
```
accreditation-documents/
‚îî‚îÄ‚îÄ accreditation/
    ‚îî‚îÄ‚îÄ {application_id}/
        ‚îî‚îÄ‚îÄ legal/
            ‚îú‚îÄ‚îÄ {timestamp}_business_license.pdf
            ‚îú‚îÄ‚îÄ {timestamp}_tax_certificate.pdf
            ‚îú‚îÄ‚îÄ {timestamp}_registration_certificate.pdf
            ‚îî‚îÄ‚îÄ {timestamp}_other_document.pdf
```

**–¢–∏–ø—ã —Ñ–∞–π–ª–æ–≤:** `application/pdf`, `application/msword`, `application/vnd.openxmlformats-officedocument.wordprocessingml.document`, `image/jpeg`, `image/png`

## üîß –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∫–µ—Ç–æ–≤
```sql
-- –ë–∞–∫–µ—Ç –¥–ª—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
INSERT INTO storage.buckets (id, name, public, file_size_limit, allowed_mime_types)
VALUES (
  'accreditation-certificates',
  'accreditation-certificates',
  true,
  52428800, -- 50MB
  ARRAY['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document']
);

-- –ë–∞–∫–µ—Ç –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
INSERT INTO storage.buckets (id, name, public, file_size_limit, allowed_mime_types)
VALUES (
  'accreditation-documents',
  'accreditation-documents',
  true,
  52428800, -- 50MB
  ARRAY['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'image/jpeg', 'image/png']
);
```

### 2. API –∏–∑–º–µ–Ω–µ–Ω–∏—è
```typescript
// –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —Ç–æ–≤–∞—Ä–æ–≤
const { data: uploadData, error: uploadError } = await supabase.storage
  .from('accreditation-certificates')
  .upload(fileName, certFile.file, {
    cacheControl: '3600',
    upsert: false
  });

// –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
const { data: uploadData, error: uploadError } = await supabase.storage
  .from('accreditation-documents')
  .upload(fileName, docFile.file, {
    cacheControl: '3600',
    upsert: false
  });

// –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ (–æ—Å—Ç–∞–µ—Ç—Å—è –≤ project-images)
const { data: uploadData, error: uploadError } = await supabase.storage
  .from('project-images')
  .upload(fileName, imageFile.file, {
    cacheControl: '3600',
    upsert: false
  });
```

## üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 1. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –≤–µ–±, —Å–∂–∞—Ç–∏–µ, CDN
- **–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã:** –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ, –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–î–æ–∫—É–º–µ–Ω—Ç—ã:** –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ, –∞—É–¥–∏—Ç

### 2. –ì–∏–±–∫–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- **–†–∞–∑–Ω—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ RLS** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ —Ñ–∞–π–ª–æ–≤
- **–†–∞–∑–Ω—ã–µ –ª–∏–º–∏—Ç—ã —Ä–∞–∑–º–µ—Ä–∞** —Ñ–∞–π–ª–æ–≤
- **–†–∞–∑–Ω—ã–µ MIME-—Ç–∏–ø—ã** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–∞–∫–µ—Ç–∞

### 3. –ü—Ä–æ—Å—Ç–æ—Ç–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **–ß–µ—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** –ø–∞–ø–æ–∫
- **–õ–µ–≥–∫–∏–π –ø–æ–∏—Å–∫** —Ñ–∞–π–ª–æ–≤ –ø–æ —Ç–∏–ø—É
- **–ü—Ä–æ—Å—Ç–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**

### 4. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- **–†–∞–∑–Ω—ã–µ CDN** –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–¥ —Ç–∏–ø** —Ñ–∞–π–ª–æ–≤
- **–ì–∏–±–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º

## üöÄ –ú–∏–≥—Ä–∞—Ü–∏—è

### 1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ –±–∞–∫–µ—Ç—ã
```bash
# –í—ã–ø–æ–ª–Ω–∏—Ç—å SQL —Å–∫—Ä–∏–ø—Ç
psql -d your_database -f fix-accreditation-storage.sql
```

### 2. –û–±–Ω–æ–≤–∏—Ç—å API
```bash
# –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ –≤ submit-accreditation/route.ts
# –ò–∑–º–µ–Ω–∏—Ç—å –±–∞–∫–µ—Ç—ã –¥–ª—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
```

### 3. –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã
```sql
-- –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤
-- –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∏–∑ project-images –≤ accreditation-certificates
-- –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏–∑ project-images –≤ accreditation-documents
```

### 4. –û–±–Ω–æ–≤–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
```typescript
// –û–±–Ω–æ–≤–∏—Ç—å URL –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
// –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤
// –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
```

## üìã –ß–µ–∫-–ª–∏—Å—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

- [ ] –°–æ–∑–¥–∞—Ç—å –±–∞–∫–µ—Ç—ã `accreditation-certificates` –∏ `accreditation-documents`
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ RLS –¥–ª—è –Ω–æ–≤—ã—Ö –±–∞–∫–µ—Ç–æ–≤
- [ ] –û–±–Ω–æ–≤–∏—Ç—å API –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –±–∞–∫–µ—Ç–æ–≤
- [ ] –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:
- ‚úÖ **–ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ** —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** —Ö—Ä–∞–Ω–µ–Ω–∏—è
- ‚úÖ **–ì–∏–±–∫–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞
- ‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è** –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º** —Ö–æ—Ä–æ—à–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã 