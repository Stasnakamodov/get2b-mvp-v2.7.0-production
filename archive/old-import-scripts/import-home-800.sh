#!/bin/bash
# –ò–º–ø–æ—Ä—Ç 800 —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –¥–æ–º–∞ —á–µ—Ä–µ–∑ OTAPI
export OTAPI_INSTANCE_KEY=4722589f-fded-4e56-8765-b422d6aebf03

cd /Users/user/Desktop/godplisgomvp-forvercel

echo "üè† –ù–∞—á–∏–Ω–∞–µ–º –∏–º–ø–æ—Ä—Ç 800 —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –¥–æ–º–∞..."
echo "–í—Ä–µ–º—è —Å—Ç–∞—Ä—Ç–∞: $(date)"

declare -a queries=(
  "–¥–∏–≤–∞–Ω –∫—Ä–µ—Å–ª–æ –º–µ–±–µ–ª—å –≥–æ—Å—Ç–∏–Ω–∞—è:40"
  "–∂—É—Ä–Ω–∞–ª—å–Ω—ã–π —Å—Ç–æ–ª–∏–∫ —Ç—É–º–±–∞ –ø–æ–¥ —Ç–µ–ª–µ–≤–∏–∑–æ—Ä:30"
  "—à–∫–∞—Ñ —Å—Ç–µ–ª–ª–∞–∂ –∫–Ω–∏–∂–Ω—ã–π:30"
  "–∫—Ä–æ–≤–∞—Ç—å –¥–≤—É—Å–ø–∞–ª—å–Ω–∞—è –º–∞—Ç—Ä–∞—Å:40"
  "–∫–æ–º–æ–¥ –ø—Ä–∏–∫—Ä–æ–≤–∞—Ç–Ω–∞—è —Ç—É–º–±–æ—á–∫–∞:20"
  "—à–∫–∞—Ñ –∫—É–ø–µ –≥–∞—Ä–¥–µ—Ä–æ–±:20"
  "–±–ª–µ–Ω–¥–µ—Ä –º–∏–∫—Å–µ—Ä –∫—É—Ö–æ–Ω–Ω—ã–π –∫–æ–º–±–∞–π–Ω:50"
  "–ø–æ—Å—É–¥–∞ –∫–∞—Å—Ç—Ä—é–ª—è —Å–∫–æ–≤–æ—Ä–æ–¥–∞:30"
  "–º—É–ª—å—Ç–∏–≤–∞—Ä–∫–∞ –ø–∞—Ä–æ–≤–∞—Ä–∫–∞ —ç–ª–µ–∫—Ç—Ä–æ–≥—Ä–∏–ª—å:20"
  "–ø–æ—Å—Ç–µ–ª—å–Ω–æ–µ –±–µ–ª—å–µ –∫–æ–º–ø–ª–µ–∫—Ç:40"
  "—à—Ç–æ—Ä—ã –∑–∞–Ω–∞–≤–µ—Å–∫–∏ —Ç—é–ª—å:30"
  "–ø–æ–ª–æ—Ç–µ–Ω—Ü–µ –±–∞–Ω–Ω–æ–µ —Ö–∞–ª–∞—Ç:30"
  "–ª—é—Å—Ç—Ä–∞ –ø–æ—Ç–æ–ª–æ—á–Ω–∞—è —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫:40"
  "–Ω–∞—Å—Ç–æ–ª—å–Ω–∞—è –ª–∞–º–ø–∞ —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫:20"
  "—É–ª–∏—á–Ω—ã–π —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫ —Ñ–æ–Ω–∞—Ä—å:20"
  "–∫–∞—Ä—Ç–∏–Ω–∞ –ø–æ—Å—Ç–µ—Ä —Ä–∞–º–∫–∞:30"
  "–≤–∞–∑–∞ –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Å—Ç–∞—Ç—É—ç—Ç–∫–∞:30"
  "—á–∞—Å—ã –Ω–∞—Å—Ç–µ–Ω–Ω—ã–µ –∑–µ—Ä–∫–∞–ª–æ:40"
  "–∫–æ—Ä–∑–∏–Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ö—Ä–∞–Ω–µ–Ω–∏–µ:40"
  "–æ—Ä–≥–∞–Ω–∞–π–∑–µ—Ä –¥–ª—è –æ–¥–µ–∂–¥—ã:40"
  "—É–º–Ω–∞—è –ª–∞–º–ø–∞ smart RGB:30"
  "–¥–∞—Ç—á–∏–∫ –∫–∞–º–µ—Ä–∞ WiFi:30"
  "—É–º–Ω–∞—è —Ä–æ–∑–µ—Ç–∫–∞ smart plug:20"
  "—Å–º–µ—Å–∏—Ç–µ–ª—å –¥—É—à–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞:40"
  "–ø–æ–ª–æ—Ç–µ–Ω—Ü–µ—Å—É—à–∏—Ç–µ–ª—å –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã –≤–∞–Ω–Ω–∞—è:40"
)

total_imported=0
total_errors=0

for item in "${queries[@]}"
do
  query="${item%%:*}"
  limit="${item##*:}"

  echo ""
  echo "=========================================="
  echo "üì¶ –ò–º–ø–æ—Ä—Ç: '$query' (–ª–∏–º–∏—Ç: $limit)"
  echo "=========================================="

  node scripts/import-from-otapi.js \
    --query="$query" \
    --category="–î–æ–º –∏ –±—ã—Ç" \
    --limit=$limit 2>&1

  exit_code=$?
  if [ $exit_code -eq 0 ]; then
    total_imported=$((total_imported + limit))
  else
    total_errors=$((total_errors + 1))
    echo "‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ '$query'"
  fi

  echo "‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å: ~$total_imported / 800 (–æ—à–∏–±–æ–∫: $total_errors)"

  # –ü–∞—É–∑–∞ 3 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
  sleep 3
done

echo ""
echo "=========================================="
echo "üéâ –ò–ú–ü–û–†–¢ –ó–ê–í–ï–†–®–ï–ù!"
echo "–í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è: $(date)"
echo "–í—Å–µ–≥–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: ~$total_imported —Ç–æ–≤–∞—Ä–æ–≤"
echo "–û—à–∏–±–æ–∫: $total_errors"
echo "=========================================="
