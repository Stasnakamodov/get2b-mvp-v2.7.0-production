# üè¶ –ò–ó–í–õ–ï–ß–ï–ù–ò–ï –ë–ê–ù–ö–û–í–°–ö–ò–• –†–ï–ö–í–ò–ó–ò–¢–û–í –ò–ó –ò–ù–í–û–ô–°–ê

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 12 —è–Ω–≤–∞—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–§–∞–π–ª—ã:** 
- `app/dashboard/project-constructor/page.tsx`
- `app/api/document-analysis/route.ts`

---

## üéØ **–û–ë–©–ê–Ø –ö–û–ù–¶–ï–ü–¶–ò–Ø**

### **–ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ:**
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤ –∏–∑ –∏–Ω–≤–æ–π—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã –¥–ª—è —à–∞–≥–æ–≤ 4 –∏ 5 –∞—Ç–æ–º–∞—Ä–Ω–æ–≥–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞.

### **–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. **OCR –∞–Ω–∞–ª–∏–∑ –∏–Ω–≤–æ–π—Å–∞** ‚Üí –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ** ‚Üí "–ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥" –∫–∞–∫ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã
3. **–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤** ‚Üí –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–π —à–∞–≥–∞ 5 –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –∏–Ω–≤–æ–π—Å–∞
4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å** ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## üèóÔ∏è **–ê–†–•–ò–¢–ï–ö–¢–£–†–ê**

### **1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤ (Backend)**
```typescript
// app/api/document-analysis/route.ts
function extractBankRequisitesFromInvoice(text: string) {
  // –ü–æ–∏—Å–∫ –Ω–æ–º–µ—Ä–∞ —Å—á–µ—Ç–∞: USD A/C NO., EUR A/C NO.
  // –ü–æ–∏—Å–∫ SWIFT –∫–æ–¥–∞: SWIFT CODE, BIC
  // –ü–æ–∏—Å–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª—è: ACCOUNT NAME, BENEFICIARY
  // –ü–æ–∏—Å–∫ –∞–¥—Ä–µ—Å–∞: BENEFICIARY'S ADDRESS
  // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–∞–ª—é—Ç—ã: USD/EUR
}
```

### **2. –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (Frontend)**
```typescript
// app/dashboard/project-constructor/page.tsx
const suggestPaymentMethodAndRequisites = (bankRequisites: any) => {
  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º "–ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥"
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –∫–∞–∫ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
  // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö
}
```

### **3. UI –¥–ª—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π**
```typescript
// PaymentMethodForm - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ "–ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥"
// RequisitesForm - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã
```

---

## üìã **–ò–ó–í–õ–ï–ö–ê–ï–ú–´–ï –î–ê–ù–ù–´–ï**

### **–ò–∑ –∏–Ω–≤–æ–π—Å–∞:**
- ‚úÖ **USD A/C NO.:** 397475795838 ‚Üí `accountNumber`
- ‚úÖ **SWIFT CODE:** BKCHCNBJ92B ‚Üí `swift`  
- ‚úÖ **ACCOUNT NAME:** ZHEJIANG GAMMA TRADING CO.,LTD ‚Üí `recipientName`
- ‚úÖ **BENEFICIARY'S ADDRESS:** ROOM201, NO.1166LONGRUI AVENUE... ‚Üí `recipientAddress`

### **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è:**
- ‚úÖ **–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:** "bank-transfer" (–ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥)
- ‚úÖ **–í–∞–ª—é—Ç–∞:** "USD" (–∏–∑ USD A/C NO.)

---

## üîß **–†–ï–ê–õ–ò–ó–ê–¶–ò–Ø**

### **1. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è analyzeSpecification**
```typescript
const analyzeSpecification = async (fileUrl: string, fileType: string) => {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ ...
  
  // üî• –ù–û–í–û–ï: –ò–∑–≤–ª–µ–∫–∞–µ–º –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã
  const bankRequisites = extractBankRequisitesFromInvoice(extractedData, analysisText);
  
  // üî• –ù–û–í–û–ï: –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã –∏ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã
  if (bankRequisites.hasRequisites) {
    suggestPaymentMethodAndRequisites(bankRequisites);
  }
}
```

### **2. –§—É–Ω–∫—Ü–∏—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤**
```typescript
const extractBankRequisitesFromInvoice = (extractedData: any, analysisText: string) => {
  // –ü–æ–∏—Å–∫ –ø–æ regex –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ OCR –æ—à–∏–±–æ–∫
  // –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
  return {
    accountNumber: '397475795838',
    swift: 'BKCHCNBJ92B',
    recipientName: 'ZHEJIANG GAMMA TRADING CO.,LTD',
    recipientAddress: 'ROOM201, NO.1166LONGRUI AVENUE...',
    transferCurrency: 'USD',
    hasRequisites: true
  };
};
```

### **3. –§—É–Ω–∫—Ü–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö**
```typescript
const suggestPaymentMethodAndRequisites = (bankRequisites: any) => {
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ manualData[4] –∏ manualData[5]
  // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º stepConfigs[4] = 'ocr_suggestion'
  // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º stepConfigs[5] = 'ocr_suggestion'
};
```

---

## üé® **UI –ö–û–ú–ü–û–ù–ï–ù–¢–´**

### **PaymentMethodForm —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏:**
```typescript
{hasSuggestion && (
  <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
    <div className="flex items-center gap-2 mb-2">
      <Eye className="h-4 w-4 text-blue-600" />
      <span className="text-sm font-medium text-blue-800">
        –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏–∑ –∏–Ω–≤–æ–π—Å–∞
      </span>
    </div>
    <p className="text-sm text-blue-700 mb-3">
      –ù–∞ –æ—Å–Ω–æ–≤–µ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤ –≤ –∏–Ω–≤–æ–π—Å–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º:
    </p>
    <div className="bg-white border border-blue-300 rounded p-3">
      <span className="text-sm font-medium">–ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥</span>
    </div>
  </div>
)}
```

### **RequisitesForm —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏:**
```typescript
{hasSuggestion && (
  <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
    {/* –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã */}
    {initialData.accountNumber && (
      <div>
        <span className="text-xs text-gray-600">–ù–æ–º–µ—Ä —Å—á–µ—Ç–∞:</span>
        <p className="text-sm font-medium">{initialData.accountNumber}</p>
      </div>
    )}
    {/* ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è ... */}
  </div>
)}
```

---

## üîç **REGEX –ü–ê–¢–¢–ï–†–ù–´**

### **–ù–æ–º–µ—Ä —Å—á–µ—Ç–∞:**
```javascript
/USD\s*A\/C\s*NO\.?\s*:?\s*(\d+)/i
/EUR\s*A\/C\s*NO\.?\s*:?\s*(\d+)/i
/Account\s*Number\s*:?\s*(\d+)/i
```

### **SWIFT –∫–æ–¥:**
```javascript
/SWIFT\s*CODE\s*:?\s*([A-Z]{6}[A-Z0-9]{2}([A-Z0-9]{3})?)/i
/SWIF\s*CODE\s*:?\s*([A-Z]{6}[A-Z0-9]{2}([A-Z0-9]{3})?)/i  // –î–ª—è –æ–ø–µ—á–∞—Ç–æ–∫
```

### **–ü–æ–ª—É—á–∞—Ç–µ–ª—å:**
```javascript
/ACCOUNT\s*NAME\s*:?\s*([^\n]+)/i
/ACCOUNT\s*NAME\s*\(Ë¥¶Êà∑ÂêçÁß∞\)\s*:?\s*([^\n]+)/i  // –ö–∏—Ç–∞–π—Å–∫–∏–π
```

### **–ê–¥—Ä–µ—Å:**
```javascript
/BENEFICIARY'?S?\s*ADDRESS\s*:?\s*([^\n]+(?:\n[^\n]+)*)/i
/BENEFICIARY'?S?\s*ADDRESS\s*\(Êî∂Ê¨æ‰∫∫Âú∞ÂùÄ\)\s*:?\s*([^\n]+(?:\n[^\n]+)*)/i
```

---

## üß™ **–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï**

### **–¢–µ—Å—Ç–æ–≤—ã–π –∏–Ω–≤–æ–π—Å:**
```
BENEFICIARY'S INFORMATION (Êî∂Ê¨æ‰∫∫‰ø°ÊÅØ)
USD A/C NO. (ÁæéÂÖÉË¥¶Êà∑Âè∑Á†Å): 397475795838
SWIF CODE(): BKCHCNBJ92B
ACCOUNT NAME (Ë¥¶Êà∑ÂêçÁß∞): ZHEJIANG GAMMA TRADING CO.,LTD
BENEFICIARY'S ADDRESS (Êî∂Ê¨æ‰∫∫Âú∞ÂùÄ): ROOM201, NO.1166LONGRUI AVENUE...
```

### **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ù–æ–º–µ—Ä —Å—á–µ—Ç–∞: 397475795838
- ‚úÖ SWIFT –∫–æ–¥: BKCHCNBJ92B
- ‚úÖ –ü–æ–ª—É—á–∞—Ç–µ–ª—å: ZHEJIANG GAMMA TRADING CO.,LTD
- ‚úÖ –ê–¥—Ä–µ—Å: ROOM201, NO.1166LONGRUI AVENUE...
- ‚úÖ –í–∞–ª—é—Ç–∞: USD
- ‚úÖ –°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã: –ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥

---

## üöÄ **–ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê**

### **–î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - –Ω–µ –Ω—É–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å —Ä–µ–∫–≤–∏–∑–∏—Ç—ã —Å –Ω—É–ª—è
- ‚úÖ **–ö–æ–Ω—Ç—Ä–æ–ª—å** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –Ω–µ—Ç —Ä–∏—Å–∫–∞ –æ—à–∏–±–æ–∫ –≤ –≤–∞–∂–Ω—ã—Ö —Ä–µ–∫–≤–∏–∑–∏—Ç–∞—Ö
- ‚úÖ **–°–∫–æ—Ä–æ—Å—Ç—å** - –±—ã—Å—Ç—Ä–µ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

### **–î–ª—è —Å–∏—Å—Ç–µ–º—ã:**
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º OCR
- ‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- ‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

---

## üìù **–ü–õ–ê–ù–´ –†–ê–ó–í–ò–¢–ò–Ø**

### **–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ:**
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –¥—Ä—É–≥–∏—Ö –≤–∞–ª—é—Ç (CNY, RUB)
- [ ] –£–ª—É—á—à–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –∏–Ω–≤–æ–π—Å–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é SWIFT –∫–æ–¥–æ–≤

### **–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ:**
- [ ] –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–∞–Ω–∫–æ–≤—Å–∫–∏–º–∏ API –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤ 