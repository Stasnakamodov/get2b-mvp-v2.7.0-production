# –†–ï–ó–Æ–ú–ï –ê–ù–ê–õ–ò–ó–ê –°–ò–°–¢–ï–ú–´ –ü–û–î–ö–ê–¢–ï–ì–û–†–ò–ô

## –ì–õ–ê–í–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê

**–ö–∞—Ç–µ–≥–æ—Ä–∏—è "–¢–ï–°–¢–û–í–ê–Ø" –∏–º–µ–µ—Ç 111 —Ç–æ–≤–∞—Ä–æ–≤, –Ω–æ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è "–¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 0 —Ç–æ–≤–∞—Ä–æ–≤.**

---

## –î–ò–ê–ì–ù–û–ó

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é "–¢–ï–°–¢–û–í–ê–Ø" - –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚úÖ
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é "–¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã" - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `selectedSubcategoryData` —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ null ‚úÖ
3. –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "üì¶ –¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã (111 —Ç–æ–≤–∞—Ä–æ–≤)" ‚úÖ
4. ‚ùå **–ù–û:** –°–µ—Ç–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –æ—Å—Ç–∞—ë—Ç—Å—è –ø—É—Å—Ç–æ–π (0 —Ç–æ–≤–∞—Ä–æ–≤)

### –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞

`ProductGridByCategory` –ø–æ–ª—É—á–∞–µ—Ç –¢–û–õ–¨–ö–û –Ω–∞–∑–≤–∞–Ω–∏–µ –ö–ê–¢–ï–ì–û–†–ò–ò ("–¢–ï–°–¢–û–í–ê–Ø"), –Ω–æ –ù–ï –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ü–û–î–ö–ê–¢–ï–ì–û–†–ò–ò ("–¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã").

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
1. ProductGridByCategory –ø–æ–ª—É—á–∞–µ—Ç: `selectedCategory = "–¢–ï–°–¢–û–í–ê–Ø"`
2. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –∑–Ω–∞–µ—Ç –æ `selectedSubcategoryData`
3. –§—É–Ω–∫—Ü–∏—è `loadProducts` –≤—ã–∑—ã–≤–∞–µ—Ç API —Å: `/api/catalog/products-by-category/–¢–ï–°–¢–û–í–ê–Ø`
4. RPC —Ñ—É–Ω–∫—Ü–∏—è –≤ –ë–î –ø–æ–ª—É—á–∞–µ—Ç: `category_name = "–¢–ï–°–¢–û–í–ê–Ø"`
5. RPC –∏—â–µ—Ç —Ç–æ–≤–∞—Ä—ã –≥–¥–µ: `category = "–¢–ï–°–¢–û–í–ê–Ø" OR sub.name = "–¢–ï–°–¢–û–í–ê–Ø"`
   - –ü–µ—Ä–≤–æ–µ —É—Å–ª–æ–≤–∏–µ –º–∞—Ç—á–∏—Ç—Å—è ‚Üí –Ω–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
   - –°–∏—Å—Ç–µ–º–∞ –Ω–µ –∑–Ω–∞–µ—Ç, —á—Ç–æ –Ω—É–∂–Ω–∞ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è "–¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã"
6. –†–µ–∑—É–ª—å—Ç–∞—Ç: 0 —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ–∫–∞–∑–∞–Ω–æ (—Ö–æ—Ç—è –≤ –ë–î –æ–Ω–∏ –µ—Å—Ç—å)

---

## –ú–ï–°–¢–û–ü–û–õ–û–ñ–ï–ù–ò–Ø –ü–†–û–ë–õ–ï–ú

### 1. ProductGridByCategory.tsx (interface, —Å—Ç—Ä–æ–∫–∏ 62-71)
```
–ü—Ä–æ–ø—Å `selectedSubcategory` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ interface ProductGridByCategoryProps
```

### 2. ProductGridByCategory.tsx (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, —Å—Ç—Ä–æ–∫–∏ 95-104)
```
`selectedSubcategory` –Ω–µ –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–µ—Ç—Å—è –∏–∑ props
```

### 3. ProductGridByCategory.tsx (useEffect, —Å—Ç—Ä–æ–∫–∏ 115-118)
```
`selectedSubcategory` –Ω–µ –≤–∫–ª—é—á–µ–Ω–∞ –≤ –º–∞—Å—Å–∏–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
–¢–æ–≤–∞—Ä—ã –Ω–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –¥—Ä—É–≥–æ–π –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
```

### 4. ProductGridByCategory.tsx (loadProducts, —Å—Ç—Ä–æ–∫–∏ 126-145)
```
–§—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ `selectedCategory`, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç `selectedSubcategory`
API –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å –∏–º–µ–Ω–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤–º–µ—Å—Ç–æ –∏–º–µ–Ω–∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
```

### 5. page.tsx (–ø–µ—Ä–µ–¥–∞—á–∞ props, —Å—Ç—Ä–æ–∫–∏ 2255-2262)
```
ProductGridByCategory –ù–ï –ø–æ–ª—É—á–∞–µ—Ç `selectedSubcategoryData`
–•–æ—Ç—è —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –∏ –Ω–µ null
```

---

## –°–ò–°–¢–ï–ú–ê –ë–î (—Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ)

```
catalog_categories
‚îú‚îÄ id: UUID
‚îú‚îÄ name: "–¢–ï–°–¢–û–í–ê–Ø"
‚îî‚îÄ (111 —Ç–æ–≤–∞—Ä–æ–≤ —Å category = "–¢–ï–°–¢–û–í–ê–Ø")

catalog_subcategories
‚îú‚îÄ id: UUID (Y)
‚îú‚îÄ category_id: UUID (—Å—Å—ã–ª–∫–∞ –Ω–∞ "–¢–ï–°–¢–û–í–ê–Ø")
‚îú‚îÄ name: "–¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã"
‚îî‚îÄ products_count: 111 (–ø–æ–¥—Å—á–∏—Ç–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ)

catalog_verified_products
‚îú‚îÄ id: UUID
‚îú‚îÄ name: "–°–º–∞—Ä—Ç—Ñ–æ–Ω Samsung..."
‚îú‚îÄ category: "–¢–ï–°–¢–û–í–ê–Ø"
‚îú‚îÄ subcategory_id: UUID (Y)  ‚Üê ‚úÖ –°–≤—è–∑—å —Ä–∞–±–æ—Ç–∞–µ—Ç!
‚îî‚îÄ specifications: {...}
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** API `/api/catalog/categories` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã –ø–æ `subcategory_id` –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "111 —Ç–æ–≤–∞—Ä–æ–≤" —Ä—è–¥–æ–º —Å –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π. –≠—Ç–æ –¥–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ë–î —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è.

---

## RPC –§–£–ù–ö–¶–ò–Ø (—Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ)

**–§–∞–π–ª:** `supabase/migrations/20251127_fix_rpc_with_subcategory_support.sql`

–§—É–Ω–∫—Ü–∏—è `get_products_by_category` –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É:
```sql
AND (
  category_name IS NULL
  OR p.category = category_name              -- ‚úÖ –ú–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
  OR sub.name = category_name                -- ‚úÖ –ú–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ –ø–æ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
)
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –§—É–Ω–∫—Ü–∏—è –ù–ò–ö–û–ì–î–ê –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –∏–º—è –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Ç–æ–ª—å–∫–æ –∏–º—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.

---

## –¢–ï–ö–£–©–ò–ô –ü–û–¢–û–ö –î–ê–ù–ù–´–• (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π)

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é
   ‚Üì
2. handleSubcategorySelect() ‚Üí setSelectedSubcategoryData()
   ‚Üì
3. –£—Å–ª–æ–≤–∏–µ !selectedSubcategoryData = false ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–≤–∞—Ä—ã
   ‚Üì
4. <ProductGridByCategory selectedCategory="–¢–ï–°–¢–û–í–ê–Ø" />
   ‚Üë
   ‚ùå selectedSubcategoryData –ù–ï –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è
   ‚Üì
5. loadProducts() –≤ ProductGridByCategory
   ‚Üì
6. fetch('/api/catalog/products-by-category/–¢–ï–°–¢–û–í–ê–Ø')
   ‚Üë
   ‚ùå –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –ö–ê–¢–ï–ì–û–†–ò–ò, –Ω–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
   ‚Üì
7. RPC —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç category_name = "–¢–ï–°–¢–û–í–ê–Ø"
   ‚Üì
8. RPC –∏—â–µ—Ç: (p.category = "–¢–ï–°–¢–û–í–ê–Ø" OR sub.name = "–¢–ï–°–¢–û–í–ê–Ø")
   ‚Üì
9. –ù–∞—Ö–æ–¥–∏—Ç –í–°–ï 111 —Ç–æ–≤–∞—Ä–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
   ‚Üì
10. ‚ùå –ù–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    ‚úó –†–µ–∑—É–ª—å—Ç–∞—Ç: 0 —Ç–æ–≤–∞—Ä–æ–≤ (—Å–∏—Å—Ç–µ–º–∞ –Ω–µ –∑–Ω–∞–µ—Ç –∫–∞–∫–æ–π —Ñ–∏–ª—å—Ç—Ä –ø—Ä–∏–º–µ–Ω–∏—Ç—å)
```

---

## –ü–†–ê–í–ò–õ–¨–ù–´–ô –ü–û–¢–û–ö –î–ê–ù–ù–´–• (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é
   ‚Üì
2. handleSubcategorySelect() ‚Üí setSelectedSubcategoryData()
   ‚Üì
3. –£—Å–ª–æ–≤–∏–µ !selectedSubcategoryData = false ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–≤–∞—Ä—ã
   ‚Üì
4. <ProductGridByCategory selectedSubcategory={selectedSubcategoryData} />
   ‚úÖ selectedSubcategoryData –ü–ï–†–ï–î–ê–Å–¢–°–Ø
   ‚Üì
5. loadProducts() –≤ ProductGridByCategory
   const categoryName = selectedSubcategory?.name || selectedCategory
   categoryName = "–¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã"
   ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º –∏–º—è –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
   ‚Üì
6. fetch('/api/catalog/products-by-category/–¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã')
   ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–º—è –ü–û–î–ö–ê–¢–ï–ì–û–†–ò–ò
   ‚Üì
7. RPC —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç category_name = "–¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã"
   ‚Üì
8. RPC –∏—â–µ—Ç: (p.category = "–¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã" OR sub.name = "–¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã")
   ‚Üì
9. –ü–µ—Ä–≤–æ–µ —É—Å–ª–æ–≤–∏–µ –Ω–µ –º–∞—Ç—á–∏—Ç—Å—è (—Ç–æ–≤–∞—Ä—ã –≤ "–¢–ï–°–¢–û–í–ê–Ø", –Ω–µ "–¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã")
   –í—Ç–æ—Ä–æ–µ —É—Å–ª–æ–≤–∏–µ –ú–ê–¢–ß–ò–¢–°–Ø! (sub.name = "–¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã")
   ‚Üì
10. –ù–∞—Ö–æ–¥–∏—Ç –≤—Å–µ —Ç–æ–≤–∞—Ä—ã —Å:
    - category = "–¢–ï–°–¢–û–í–ê–Ø" (–≤–µ—Ä–Ω–æ)
    - subcategory_id = <id –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã"> (–≤–µ—Ä–Ω–æ)
    ‚Üì
11. ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢: 111 —Ç–æ–≤–∞—Ä–æ–≤ (–∏–ª–∏ —Å–∫–æ–ª—å–∫–æ –∏—Ö –≤ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏)
```

---

## –†–ï–®–ï–ù–ò–ï (3 —Ñ–∞–π–ª–∞, 5 –∏–∑–º–µ–Ω–µ–Ω–∏–π)

### –§–∞–π–ª 1: `components/catalog/ProductGridByCategory.tsx`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ 1.1** (—Å—Ç—Ä–æ–∫–∞ ~71):
- –î–æ–±–∞–≤–∏—Ç—å –≤ interface: `selectedSubcategory?: any;`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ 1.2** (—Å—Ç—Ä–æ–∫–∞ ~102):
- –î–æ–±–∞–≤–∏—Ç—å –≤ –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—é: `selectedSubcategory,`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ 1.3** (—Å—Ç—Ä–æ–∫–∞ ~118):
- –ò–∑–º–µ–Ω–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ useEffect: `[selectedCategory, selectedSubcategory, token]`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ 1.4** (—Å—Ç—Ä–æ–∫–∞ ~127):
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É: `const categoryName = selectedSubcategory?.name || selectedCategory`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ 1.5** (—Å—Ç—Ä–æ–∫–∞ ~143):
- –ò–∑–º–µ–Ω–∏—Ç—å fetch URL: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `categoryName` –≤–º–µ—Å—Ç–æ `selectedCategory`

### –§–∞–π–ª 2: `app/dashboard/catalog/page.tsx`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ 2.1** (—Å—Ç—Ä–æ–∫–∞ ~2255):
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–ø—Å: `selectedSubcategory={selectedSubcategoryData}`

---

## –ü–†–û–í–ï–†–ö–ê (—á—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—Å—è)

**–î–û –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –í—ã–±–∏—Ä–∞–µ—Ç–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é "–¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã"
- –ó–∞–≥–æ–ª–æ–≤–æ–∫: "üì¶ –¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã (111 —Ç–æ–≤–∞—Ä–æ–≤)"
- –°–µ—Ç–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤: **–ü–£–°–¢–û** (0 —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ–∫–∞–∑–∞–Ω–æ)

**–ü–û–°–õ–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –í—ã–±–∏—Ä–∞–µ—Ç–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é "–¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã"
- –ó–∞–≥–æ–ª–æ–≤–æ–∫: "üì¶ –¢–µ—Å—Ç–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã (111 —Ç–æ–≤–∞—Ä–æ–≤)"
- –°–µ—Ç–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤: **111 –¢–û–í–ê–†–û–í** (–≤—Å–µ —Ç–æ–≤–∞—Ä—ã –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏)

---

## –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø

### –ü–æ—á–µ–º—É –ø–æ–¥—Å—á—ë—Ç —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "111"?
API `/api/catalog/categories` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∏—Å–ø–æ–ª—å–∑—É—è:
```typescript
.select('*', { count: 'exact', head: true })
.eq('subcategory_id', sub.id)
```

–≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –∏—â–µ—Ç –ø–æ `subcategory_id`.

### –ü–æ—á–µ–º—É RPC —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞–ø–∏—Å–∞–Ω–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π?
–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —É–∂–µ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–ª —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
```sql
OR sub.name = category_name  -- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–∏—Å–∫–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏
```

–ù–æ ProductGridByCategory –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç—É –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å.

### –ü–æ—á–µ–º—É —ç—Ç–æ –Ω–µ –±—ã–ª–æ –∑–∞–º–µ—á–µ–Ω–æ —Ä–∞–Ω—å—à–µ?
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –±—ã–ª–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ (RPC —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π)
- –ù–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –±—ã–ª –æ–±–Ω–æ–≤–ª—ë–Ω –¥–ª—è –µ—ë –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ü–æ–ª—É—á–∞–µ—Ç—Å—è "–ø–æ–ª–æ–≤–∏–Ω—á–∞—Ç–æ–µ" —Ä–µ—à–µ–Ω–∏–µ: —Ñ—Ä–æ–Ω—Ç –Ω–µ –∑–Ω–∞–µ—Ç –æ —Ç–æ–º, —á—Ç–æ –±—ç–∫ –≥–æ—Ç–æ–≤

---

## –°–¢–ê–¢–£–° –î–†–£–ì–ò–• –ö–û–ú–ü–û–ù–ï–ù–¢–û–í

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|-----------|------|--------|-----------|
| SubcategoryList | `components/catalog/SubcategoryList.tsx` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å—á—ë—Ç—á–∏–∫–∏ |
| API /categories | `app/api/catalog/categories/route.ts` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã –ø–æ subcategory_id |
| API /categories/[id]/subcategories | `app/api/catalog/categories/[id]/subcategories/route.ts` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –¢–∞–∫–∂–µ –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ |
| API /products-by-category | `app/api/catalog/products-by-category/[category]/route.ts` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ü—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç RPC —Ñ—É–Ω–∫—Ü–∏—é |
| RPC get_products_by_category | `supabase/migrations/...sql` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –õ–æ–≥–∏–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–∞ —Å–ª—É—á–∞—è (–∫–∞—Ç–µ–≥–æ—Ä–∏—è –∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è) |
| ProductGridByCategory | `components/catalog/ProductGridByCategory.tsx` | ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ | –ù–µ –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ |
| page.tsx | `app/dashboard/catalog/page.tsx` | ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ | –ù–µ –ø–µ—Ä–µ–¥–∞—ë—Ç –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç |

---

## –í–´–í–û–î

–≠—Ç–æ –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞ –ë–î, –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞ API, –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞ RPC —Ñ—É–Ω–∫—Ü–∏–∏.

**–≠—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏.**

`selectedSubcategoryData` —Å–æ–∑–¥–∞—ë—Ç—Å—è, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, –Ω–æ –Ω–µ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —Ç—É–¥–∞, –≥–¥–µ –Ω—É–∂–Ω–∞.

ProductGridByCategory —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–ø–æ–ª—É—á–∞–µ—Ç –∏–º—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤–º–µ—Å—Ç–æ –∏–º–µ–Ω–∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏).

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–¥–∞—Ç—å `selectedSubcategoryData` –≤ ProductGridByCategory –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë –∏–º—è –¥–ª—è API –∑–∞–ø—Ä–æ—Å–∞.

